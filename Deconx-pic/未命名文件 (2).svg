<svg id="SvgjsSvg1606" width="647.7708740234375" height="1185.3333435058594" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1607"><marker id="SvgjsMarker1632" markerWidth="18" markerHeight="14" refX="12" refY="7" viewBox="0 0 18 14" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1633" d="M0,0 L18,7 L0,14 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1672" markerWidth="18" markerHeight="14" refX="12" refY="7" viewBox="0 0 18 14" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1673" d="M0,0 L18,7 L0,14 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1690" markerWidth="18" markerHeight="14" refX="12" refY="7" viewBox="0 0 18 14" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1691" d="M0,0 L18,7 L0,14 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1710" markerWidth="18" markerHeight="14" refX="12" refY="7" viewBox="0 0 18 14" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1711" d="M0,0 L18,7 L0,14 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1736" markerWidth="18" markerHeight="14" refX="12" refY="7" viewBox="0 0 18 14" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1737" d="M0,0 L18,7 L0,14 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1754" markerWidth="18" markerHeight="14" refX="12" refY="7" viewBox="0 0 18 14" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1755" d="M0,0 L18,7 L0,14 L0,0" fill="#212121" stroke="#212121" stroke-width="1"></path></marker></defs><g id="SvgjsG1608" transform="translate(25.01014285155196,25.009909268423456)"><path id="SvgjsPath1609" d="M 0 4Q 0 0 4 0L 593 0Q 597 0 597 4L 597 263.9692624845062Q 597 267.9692624845062 593 267.9692624845062L 4 267.9692624845062Q 0 267.9692624845062 0 263.9692624845062Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1610" d="M 0 30L 597 30" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><path id="SvgjsPath1611" d="M 0 0L 597 0L 597 267.9692624845062L 0 267.9692624845062Z" stroke="none" fill="none"></path><g id="SvgjsG1612"><text id="SvgjsText1613" font-family="微软雅黑" text-anchor="middle" font-size="24px" width="577px" fill="#b71c1c" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="24px" weight="700" font-style="" opacity="1" y="-6" transform="rotate(0)"><tspan id="SvgjsTspan1614" dy="30" x="298.5"><tspan id="SvgjsTspan1615" style="text-decoration:;">用户态</tspan></tspan></text></g><g id="SvgjsG1616"><text id="SvgjsText1617" font-family="微软雅黑" text-anchor="start" font-size="24px" width="577px" fill="#b71c1c" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="24px" weight="400" font-style="" opacity="1" y="127.9846312422531" transform="rotate(0)"></text></g></g><g id="SvgjsG1618" transform="translate(244.85640346692753,69.74107142857144)"><path id="SvgjsPath1619" d="M 0 4Q 0 0 4 0L 153.45033591210571 0Q 157.45033591210571 0 157.45033591210571 4L 157.45033591210571 57.942089949201865Q 157.45033591210571 61.942089949201865 153.45033591210571 61.942089949201865L 4 61.942089949201865Q 0 61.942089949201865 0 57.942089949201865Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1620" d="M 0 33L 157.45033591210571 33" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><path id="SvgjsPath1621" d="M 0 0L 157.45033591210571 0L 157.45033591210571 61.942089949201865L 0 61.942089949201865Z" stroke="none" fill="none"></path><g id="SvgjsG1622"><text id="SvgjsText1623" font-family="微软雅黑" text-anchor="middle" font-size="20px" width="138px" fill="#323232" font-weight="700" align="middle" lineHeight="150%" anchor="middle" family="微软雅黑" size="20px" weight="700" font-style="" opacity="1" y="-6.5" transform="rotate(0)"><tspan id="SvgjsTspan1624" dy="30" x="79"><tspan id="SvgjsTspan1625" style="text-decoration:;">用户程序</tspan></tspan></text></g><g id="SvgjsG1626"><text id="SvgjsText1627" font-family="微软雅黑" text-anchor="start" font-size="20px" width="138px" fill="#323232" font-weight="400" align="middle" lineHeight="150%" anchor="start" family="微软雅黑" size="20px" weight="400" font-style="" opacity="1" y="24.47104497460093" transform="rotate(0)"><tspan id="SvgjsTspan1628" dy="30" x="10"><tspan id="SvgjsTspan1629" style="text-decoration:;">trace()</tspan></tspan></text></g></g><g id="SvgjsG1630"><path id="SvgjsPath1631" d="M323.5815714229803 132.68316137777333L323.5815714229803 151.56192769248065L323.5815714229803 151.56192769248065L323.5815714229803 165.24069400718798" stroke="#323232" stroke-width="4" fill="none" marker-end="url(#SvgjsMarker1632)"></path></g><g id="SvgjsG1634" transform="translate(198.32936876368495,171.44069400718797)"><path id="SvgjsPath1635" d="M 0 4Q 0 0 4 0L 246.5044053185909 0Q 250.5044053185909 0 250.5044053185909 4L 250.5044053185909 96Q 250.5044053185909 100 246.5044053185909 100L 4 100Q 0 100 0 96Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1636" d="M 0 30L 250.5044053185909 30" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><path id="SvgjsPath1637" d="M 0 0L 250.5044053185909 0L 250.5044053185909 100L 0 100Z" stroke="none" fill="none"></path><g id="SvgjsG1638"><text id="SvgjsText1639" font-family="微软雅黑" text-anchor="middle" font-size="20px" width="231px" fill="#323232" font-weight="700" align="middle" lineHeight="150%" anchor="middle" family="微软雅黑" size="20px" weight="700" font-style="" opacity="1" y="-8" transform="rotate(0)"><tspan id="SvgjsTspan1640" dy="30" x="125.5"><tspan id="SvgjsTspan1641" style="text-decoration:;">usys.S</tspan></tspan></text></g><g id="SvgjsG1642"><text id="SvgjsText1643" font-family="微软雅黑" text-anchor="start" font-size="20px" width="231px" fill="#323232" font-weight="400" align="middle" lineHeight="150%" anchor="start" family="微软雅黑" size="20px" weight="400" font-style="" opacity="1" y="27" transform="rotate(0)"><tspan id="SvgjsTspan1644" dy="30" x="10"><tspan id="SvgjsTspan1645" style="text-decoration:;">将系统调用号保存在a7</tspan></tspan><tspan id="SvgjsTspan1646" dy="30" x="10"><tspan id="SvgjsTspan1647" style="text-decoration:;">然后ecall进入内核</tspan></tspan></text></g></g><g id="SvgjsG1648" transform="translate(25.770843505859375,337.3343230437854)"><path id="SvgjsPath1649" d="M 0 4Q 0 0 4 0L 593 0Q 597 0 597 4L 597 818.6448639679334Q 597 822.6448639679334 593 822.6448639679334L 4 822.6448639679334Q 0 822.6448639679334 0 818.6448639679334Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1650" d="M 0 30L 597 30" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><path id="SvgjsPath1651" d="M 0 0L 597 0L 597 822.6448639679334L 0 822.6448639679334Z" stroke="none" fill="none"></path><g id="SvgjsG1652"><text id="SvgjsText1653" font-family="微软雅黑" text-anchor="middle" font-size="24px" width="577px" fill="#b71c1c" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="24px" weight="700" font-style="" opacity="1" y="-6" transform="rotate(0)"><tspan id="SvgjsTspan1654" dy="30" x="298.5"><tspan id="SvgjsTspan1655" style="text-decoration:;">内核态</tspan></tspan></text></g><g id="SvgjsG1656"><text id="SvgjsText1657" font-family="微软雅黑" text-anchor="start" font-size="24px" width="577px" fill="#b71c1c" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="24px" weight="400" font-style="" opacity="1" y="405.3224319839667" transform="rotate(0)"></text></g></g><g id="SvgjsG1658" transform="translate(157.37858841680105,400.95910065705334)"><path id="SvgjsPath1659" d="M 0 4Q 0 0 4 0L 328.4059660123591 0Q 332.4059660123591 0 332.4059660123591 4L 332.4059660123591 62.68675302133181Q 332.4059660123591 66.68675302133181 328.4059660123591 66.68675302133181L 4 66.68675302133181Q 0 66.68675302133181 0 62.68675302133181Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1660" d="M 0 30L 332.4059660123591 30" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><path id="SvgjsPath1661" d="M 0 0L 332.4059660123591 0L 332.4059660123591 66.68675302133181L 0 66.68675302133181Z" stroke="none" fill="none"></path><g id="SvgjsG1662"><text id="SvgjsText1663" font-family="微软雅黑" text-anchor="middle" font-size="20px" width="313px" fill="#323232" font-weight="700" align="middle" lineHeight="150%" anchor="middle" family="微软雅黑" size="20px" weight="700" font-style="" opacity="1" y="-8" transform="rotate(0)"><tspan id="SvgjsTspan1664" dy="30" x="166.5"><tspan id="SvgjsTspan1665" style="text-decoration:;">trampoline.S</tspan></tspan></text></g><g id="SvgjsG1666"><text id="SvgjsText1667" font-family="微软雅黑" text-anchor="start" font-size="20px" width="313px" fill="#323232" font-weight="400" align="middle" lineHeight="150%" anchor="start" family="微软雅黑" size="20px" weight="400" font-style="" opacity="1" y="25.343376510665905" transform="rotate(0)"><tspan id="SvgjsTspan1668" dy="30" x="10"><tspan id="SvgjsTspan1669" style="text-decoration:;">设置部分信息，跳转至usertrap()</tspan></tspan></text></g></g><g id="SvgjsG1670"><path id="SvgjsPath1671" d="M323.99823808964726 468.64585367838515L323.99823808964726 489.6014945412584L323.99823808964726 489.6014945412584L323.99823808964726 505.35713540413167" stroke="#323232" stroke-width="4" fill="none" marker-end="url(#SvgjsMarker1672)"></path></g><g id="SvgjsG1674" transform="translate(124.99823808964737,511.5571354041317)"><path id="SvgjsPath1675" d="M 0 4Q 0 0 4 0L 394 0Q 398 0 398 4L 398 96Q 398 100 394 100L 4 100Q 0 100 0 96Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1676" d="M 0 30L 398 30" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><path id="SvgjsPath1677" d="M 0 0L 398 0L 398 100L 0 100Z" stroke="none" fill="none"></path><g id="SvgjsG1678"><text id="SvgjsText1679" font-family="微软雅黑" text-anchor="middle" font-size="20px" width="378px" fill="#323232" font-weight="700" align="middle" lineHeight="150%" anchor="middle" family="微软雅黑" size="20px" weight="700" font-style="" opacity="1" y="-8" transform="rotate(0)"><tspan id="SvgjsTspan1680" dy="30" x="199"><tspan id="SvgjsTspan1681" style="text-decoration:;">trap.c</tspan></tspan></text></g><g id="SvgjsG1682"><text id="SvgjsText1683" font-family="微软雅黑" text-anchor="start" font-size="20px" width="378px" fill="#323232" font-weight="400" align="middle" lineHeight="150%" anchor="start" family="微软雅黑" size="20px" weight="400" font-style="" opacity="1" y="27" transform="rotate(0)"><tspan id="SvgjsTspan1684" dy="30" x="10"><tspan id="SvgjsTspan1685" style="text-decoration:;">判断是否为系统调用</tspan></tspan><tspan id="SvgjsTspan1686" dy="30" x="10"><tspan id="SvgjsTspan1687" style="text-decoration:;">如果是，设置进程状态，然后调用syscall()</tspan></tspan></text></g></g><g id="SvgjsG1688"><path id="SvgjsPath1689" d="M323.99823808964715 612.5571354041317L323.99823808964715 632.286378611846L323.99823808964715 632.286378611846L323.99823808964715 648.0420194747193" stroke="#323232" stroke-width="4" fill="none" marker-end="url(#SvgjsMarker1690)"></path></g><g id="SvgjsG1692" transform="translate(124.99823808964737,654.2420194747193)"><path id="SvgjsPath1693" d="M 0 4Q 0 0 4 0L 394 0Q 398 0 398 4L 398 123.18160011349687Q 398 127.18160011349687 394 127.18160011349687L 4 127.18160011349687Q 0 127.18160011349687 0 123.18160011349687Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1694" d="M 0 30L 398 30" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><path id="SvgjsPath1695" d="M 0 0L 398 0L 398 127.18160011349687L 0 127.18160011349687Z" stroke="none" fill="none"></path><g id="SvgjsG1696"><text id="SvgjsText1697" font-family="微软雅黑" text-anchor="middle" font-size="20px" width="378px" fill="#323232" font-weight="700" align="middle" lineHeight="150%" anchor="middle" family="微软雅黑" size="20px" weight="700" font-style="" opacity="1" y="-8" transform="rotate(0)"><tspan id="SvgjsTspan1698" dy="30" x="199"><tspan id="SvgjsTspan1699" style="text-decoration:;">syscall()</tspan></tspan></text></g><g id="SvgjsG1700"><text id="SvgjsText1701" font-family="微软雅黑" text-anchor="start" font-size="20px" width="378px" fill="#323232" font-weight="400" align="middle" lineHeight="150%" anchor="start" family="微软雅黑" size="20px" weight="400" font-style="" opacity="1" y="25.590800056748435" transform="rotate(0)"><tspan id="SvgjsTspan1702" dy="30" x="10"><tspan id="SvgjsTspan1703" style="text-decoration:;">根据a7寄存器中保存的系统调用号，执行</tspan></tspan><tspan id="SvgjsTspan1704" dy="30" x="10"><tspan id="SvgjsTspan1705" style="text-decoration:;">相应的系统调用</tspan></tspan><tspan id="SvgjsTspan1706" dy="30" x="10"><tspan id="SvgjsTspan1707" style="text-decoration:;">系统调用的返回值保存在a0寄存器中</tspan></tspan></text></g></g><g id="SvgjsG1708"><path id="SvgjsPath1709" d="M323.58157142298046 782.4236195882162L323.58157142298046 806.7541731720987L323.58157142298046 806.7541731720987L323.58157142298046 825.8847267559813" stroke="#323232" stroke-width="4" fill="none" marker-end="url(#SvgjsMarker1710)"></path></g><g id="SvgjsG1712" transform="translate(102.49823808964737,832.0847267559814)"><path id="SvgjsPath1713" d="M 0 4Q 0 0 4 0L 438.1666666666664 0Q 442.1666666666664 0 442.1666666666664 4L 442.1666666666664 296.6540341929622Q 442.1666666666664 300.6540341929622 438.1666666666664 300.6540341929622L 4 300.6540341929622Q 0 300.6540341929622 0 296.6540341929622Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1714" d="M 0 30L 442.1666666666664 30" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><path id="SvgjsPath1715" d="M 0 0L 442.1666666666664 0L 442.1666666666664 300.6540341929622L 0 300.6540341929622Z" stroke="none" fill="none"></path><g id="SvgjsG1716"><text id="SvgjsText1717" font-family="微软雅黑" text-anchor="middle" font-size="20px" width="423px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="20px" weight="700" font-style="" opacity="1" y="-3" transform="rotate(0)"><tspan id="SvgjsTspan1718" dy="25" x="221.5"><tspan id="SvgjsTspan1719" style="text-decoration:;">sysproc.c</tspan></tspan></text></g><g id="SvgjsG1720"><text id="SvgjsText1721" font-family="微软雅黑" text-anchor="start" font-size="20px" width="423px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="20px" weight="400" font-style="" opacity="1" y="147.3270170964811" transform="rotate(0)"></text></g></g><g id="SvgjsG1722" transform="translate(179.4105995036786,891.883948916482)"><path id="SvgjsPath1723" d="M 0 4Q 0 0 4 0L 285 0Q 289 0 289 4L 289 72.42857142857156Q 289 76.42857142857156 285 76.42857142857156L 4 76.42857142857156Q 0 76.42857142857156 0 72.42857142857156Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1724" d="M 0 30L 289 30" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><path id="SvgjsPath1725" d="M 0 0L 289 0L 289 76.42857142857156L 0 76.42857142857156Z" stroke="none" fill="none"></path><g id="SvgjsG1726"><text id="SvgjsText1727" font-family="微软雅黑" text-anchor="middle" font-size="18px" width="269px" fill="#323232" font-weight="700" align="middle" lineHeight="150%" anchor="middle" family="微软雅黑" size="18px" weight="700" font-style="" opacity="1" y="-5" transform="rotate(0)"><tspan id="SvgjsTspan1728" dy="27" x="144.5"><tspan id="SvgjsTspan1729" style="text-decoration:;">sys_trace()</tspan></tspan></text></g><g id="SvgjsG1730"><text id="SvgjsText1731" font-family="微软雅黑" text-anchor="start" font-size="18px" width="269px" fill="#323232" font-weight="400" align="middle" lineHeight="150%" anchor="start" family="微软雅黑" size="18px" weight="400" font-style="" opacity="1" y="33.21428571428578" transform="rotate(0)"><tspan id="SvgjsTspan1732" dy="27" x="10"><tspan id="SvgjsTspan1733" style="text-decoration:;">执行该系统调用</tspan></tspan></text></g></g><g id="SvgjsG1734"><path id="SvgjsPath1735" d="M323.9105995036786 969.3125203450536L323.9105995036786 986.7426762700613L323.9105995036786 986.7426762700613L323.9105995036786 998.9728321950688" stroke="#323232" stroke-width="4" fill="none" marker-end="url(#SvgjsMarker1736)"></path></g><g id="SvgjsG1738" transform="translate(179.41059950367867,1005.1728321950688)"><path id="SvgjsPath1739" d="M 0 4Q 0 0 4 0L 285 0Q 289 0 289 4L 289 96Q 289 100 285 100L 4 100Q 0 100 0 96Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1740" d="M 0 30L 289 30" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><path id="SvgjsPath1741" d="M 0 0L 289 0L 289 100L 0 100Z" stroke="none" fill="none"></path><g id="SvgjsG1742"><text id="SvgjsText1743" font-family="微软雅黑" text-anchor="middle" font-size="18px" width="269px" fill="#323232" font-weight="700" align="middle" lineHeight="150%" anchor="middle" family="微软雅黑" size="18px" weight="700" font-style="" opacity="1" y="-5" transform="rotate(0)"><tspan id="SvgjsTspan1744" dy="27" x="144.5"><tspan id="SvgjsTspan1745" style="text-decoration:;">argint()</tspan></tspan></text></g><g id="SvgjsG1746"><text id="SvgjsText1747" font-family="微软雅黑" text-anchor="start" font-size="18px" width="269px" fill="#323232" font-weight="400" align="middle" lineHeight="150%" anchor="start" family="微软雅黑" size="18px" weight="400" font-style="" opacity="1" y="31.5" transform="rotate(0)"><tspan id="SvgjsTspan1748" dy="27" x="10"><tspan id="SvgjsTspan1749" style="text-decoration:;">获得系统调用需要的参数，这里</tspan></tspan><tspan id="SvgjsTspan1750" dy="27" x="10"><tspan id="SvgjsTspan1751" style="text-decoration:;">是mask</tspan></tspan></text></g></g><g id="SvgjsG1752"><path id="SvgjsPath1753" d="M323.5815714229804 272.440694007188L323.5815714229804 335.13580287165814L323.5815714229804 335.13580287165814L323.5815714229804 394.7591006570533" stroke="#212121" stroke-width="4" fill="none" marker-end="url(#SvgjsMarker1754)"></path></g></svg>